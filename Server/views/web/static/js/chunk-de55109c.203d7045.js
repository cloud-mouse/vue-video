(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-de55109c"],{"3db4":function(e,t,n){},5582:function(e,t,n){"use strict";var i=n("c51a"),o=n.n(i);o.a},c51a:function(e,t,n){},cbb3:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"video-detail"},[n("div",{staticClass:"video-box"},[n("d-player",{ref:"player",attrs:{autoplay:e.autoplay,video:e.video},on:{ended:e.ended,play:e.play}})],1),n("div",{staticClass:"video-content"},[n("div",{staticClass:"head-title"},[n("div",{staticClass:"mv-cell"},[n("span",{staticClass:"mv-name"},[e._v(e._s(e.movieDetail.name)),n("span",{staticClass:"mv-recommend"},[e._v("("+e._s("1"===e.movieDetail.isOver?"已完结":"连载中")+")")])]),n("span",{on:{click:function(t){e.showProfile=!0}}},[e._v("简介 "),n("van-icon",{attrs:{name:"arrow"}})],1)]),n("div",{staticClass:"mv-info"},[e.movieDetail.movieClass?n("span",{staticClass:"mv-class"},[e._v("分类："+e._s(e.movieDetail.movieClass.name)+" |")]):e._e(),n("span",{staticClass:"mv-uptime"},[n("strong",[e._v("更新时间：")]),e._v(e._s(e._f("timeFormat")(e.movieDetail.updateTime)))]),n("span",{staticClass:"mv-pv"},[n("strong",[e._v("播放量：")]),e._v(e._s(e.movieDetail.pv))])])]),n("div",{staticClass:"mv-episodes"},[n("div",{staticClass:"head-title"},[n("span",[e._v("播放列表")]),n("span",{on:{click:function(t){e.showAllEpisodes=!0}}},[e._v("查看全部 "),n("van-icon",{attrs:{name:"arrow"}})],1)]),n("div",{staticClass:"episodes-list"},[e._l(e.movieEpisodes,(function(t,i){return n("div",{key:i,class:["episodes-item",e.currentIndex===i?"active":""],on:{click:function(n){return e.setCurrent(t,i)}}},[e._v(" "+e._s(i+1)+" ")])})),e.movieEpisodes.length?e._e():n("div",{staticStyle:{"text-align":"center"}},[e._v(" 暂无剧集 ")])],2)])]),n("van-popup",{staticStyle:{height:"40%"},attrs:{closeable:"",round:"",position:"bottom"},on:{close:function(t){e.showProfile=!1}},model:{value:e.showProfile,callback:function(t){e.showProfile=t},expression:"showProfile"}},[n("div",{staticClass:"title"},[e._v("简介")]),n("div",{staticClass:"description",domProps:{innerHTML:e._s(e.movieDetail.description)}})]),n("van-popup",{staticStyle:{height:"40%"},attrs:{closeable:"",round:"",position:"bottom"},on:{close:function(t){e.showAllEpisodes=!1}},model:{value:e.showAllEpisodes,callback:function(t){e.showAllEpisodes=t},expression:"showAllEpisodes"}},[n("div",{staticClass:"episodes-all"},[e._l(e.movieEpisodes,(function(t,i){return n("div",{key:i,class:["episodes-item",e.currentIndex===i?"active":""],on:{click:function(n){return e.setCurrent(t,i)}}},[e._v(" "+e._s(i+1)+" ")])})),e.movieEpisodes.length?e._e():n("div",{staticStyle:{"text-align":"center"}},[e._v(" 暂无剧集 ")])],2)])],1)},o=[],a=(n("99af"),n("b0c0"),n("96cf"),n("1da1")),s=n("fc91"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dplayer"})},r=[],c=n("f7a5"),u=n.n(c),d={props:{autoplay:{type:Boolean,default:!1},video:{type:Object,default:function(){}}},data:function(){return{dp:null}},mounted:function(){var e=this;this.$nextTick((function(){if(e._initPlayer(),e.video.url){document.querySelector(".dplayer-menu").remove(),document.querySelector(".dplayer-mask").remove(),document.querySelector(".dplayer-info-panel-item-url").remove();var t=document.querySelectorAll(".dplayer-menu-item").length;document.querySelectorAll(".dplayer-menu-item")[t-2].remove(),document.querySelectorAll(".dplayer-menu-item")[t-1].remove()}}))},methods:{_initPlayer:function(){var e=this,t=this.dp=new u.a({element:this.$el,mutex:!1,theme:"#335eea",loop:!1,lang:"zh-cn",screenshot:!0,hotkey:!0,preload:!0,volume:.7,autoplay:this.autoplay,video:{pic:this.video.pic,url:this.video.url,type:this.video.type}});t.on("play",(function(){e.$emit("play")})),t.on("quality_start",(function(){e.$emit("quality_start"),t.on("play")})),t.on("pause",(function(){e.$emit("pause")})),t.on("canplay",(function(){e.$emit("canplay")})),t.on("playing",(function(){e.$emit("playing")})),t.on("ended",(function(){e.$emit("ended")})),t.on("error",(function(){e.$emit("error")}))}}},p=d,v=(n("5582"),n("2877")),m=Object(v["a"])(p,l,r,!1,null,null,null),f=m.exports,h=(n("a623"),n("4160"),n("c975"),n("a15b"),n("d81d"),n("fb6a"),n("b64b"),n("d3b7"),n("4d63"),n("ac1f"),n("25f0"),n("466d"),n("4d90"),n("5319"),n("841c"),n("1276"),n("159b"),n("5530"),n("15fd"),n("53ca"));function y(e,t){if(0===arguments.length)return null;var n,i=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(h["a"])(e)?n=e:("string"===typeof e&&(e=/^[0-9]+$/.test(e)?parseInt(e):e.replace(new RegExp(/-/gm),"/")),"number"===typeof e&&10===e.toString().length&&(e*=1e3),n=new Date(e));var o={y:n.getFullYear(),m:n.getMonth()+1,d:n.getDate(),h:n.getHours(),i:n.getMinutes(),s:n.getSeconds(),a:n.getDay()},a=i.replace(/{([ymdhisa])+}/g,(function(e,t){var n=o[t];return"a"===t?["日","一","二","三","四","五","六"][n]:n.toString().padStart(2,"0")}));return a}function g(e,t){e=10===(""+e).length?1e3*parseInt(e):+e;var n=new Date(e),i=Date.now(),o=(i-n)/1e3;return o<30?"刚刚":o<3600?Math.ceil(o/60)+"分钟前":o<86400?Math.ceil(o/3600)+"小时前":o<172800?"1天前":t?y(e,t):n.getMonth()+1+"月"+n.getDate()+"日"+n.getHours()+"时"+n.getMinutes()+"分"}var _={name:"VideoDetail",components:{"d-player":f},filters:{timeFormat:function(e){return g(new Date(e))}},data:function(){return{movieDetail:{},video:{pic:"",url:"",type:"hls"},autoplay:!0,player:null,showProfile:!1,showAllEpisodes:!1,currentIndex:0,movieEpisodes:[],count:0}},mounted:function(){this._initData()},beforeDestroy:function(){this.ended()},methods:{play:function(){console.log("开始播放...")},ended:function(){console.log("结束播放")},_initData:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.ended(),t.next=3,s["a"].getMovie({id:e.$route.query.id}).then((function(t){e.movieDetail=t.data,e.video.pic=t.data.cover}));case 3:return t.next=5,s["c"].getMovieEpisodes({movie_id:e.$route.query.id}).then((function(t){e.movieEpisodes=t.data.list,e.count=t.data.count,e.video.url=t.data.list.length&&t.data.list[0].url,e.$nextTick((function(){e.$refs.player._initPlayer()})),document.title="".concat(e.movieDetail.name," - ").concat(t.data.list.length&&t.data.list[0].name)}));case 5:case"end":return t.stop()}}),t)})))()},setCurrent:function(e,t){var n=this;this.ended(),this.video.url=e.url,this.$nextTick((function(){n.$refs.player._initPlayer()})),document.title="".concat(this.movieDetail.name," - ").concat(e.name),this.currentIndex=t,this.showAllEpisodes=!1}}},b=_,w=(n("eee6"),Object(v["a"])(b,i,o,!1,null,null,null));t["default"]=w.exports},eee6:function(e,t,n){"use strict";var i=n("3db4"),o=n.n(i);o.a},fc91:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}));var i=n("b775"),o={getMovie:function(e){return Object(i["a"])({url:"/web-api/movie",method:"get",params:e})}},a={getMovieClass:function(e){return Object(i["a"])({url:"/web-api/movieClass",method:"get",params:e})}},s={getMovieEpisodes:function(e){return Object(i["a"])({url:"/web-api/movieEpisodes",method:"get",params:e})}}}}]);