(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20fe615f"],{"0fea":function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return o}));var n=a("b775"),i={authorityList:function(e){return Object(n["a"])({url:"/admin-api/permission",method:"get",params:e})},addRole:function(e){return Object(n["a"])({url:"/admin-api/role",method:"post",data:e})},editRole:function(e){return Object(n["a"])({url:"/admin-api/role",method:"patch",data:e})},roleList:function(e){return Object(n["a"])({url:"/admin-api/role",method:"get",params:e})},roleDetail:function(e){return Object(n["a"])({url:"/admin-api/role",method:"get",params:e})},delRole:function(e){return Object(n["a"])({url:"/admin-api/role",method:"delete",params:e})}},r={getAdminList:function(e){return Object(n["a"])({url:"/admin-api/admin",method:"get",params:e})},addAdmin:function(e){return Object(n["a"])({url:"/admin-api/admin",method:"post",data:e})},delAdmin:function(e){return Object(n["a"])({url:"/admin-api/admin",method:"get",params:e})},editAdmin:function(e){return Object(n["a"])({url:"/admin-api/admin",method:"patch",data:e})}},o={getList:function(e){return Object(n["a"])({url:"/admin-api/permission",method:"get",params:e})},addItem:function(e){return Object(n["a"])({url:"/admin-api/permission",method:"post",data:e})},updateItem:function(e){return Object(n["a"])({url:"/admin-api/permission",method:"patch",data:e})},deleteItem:function(e){return Object(n["a"])({url:"/admin-api/permission",method:"delete",params:e})}}},1735:function(e,t,a){},"44b7":function(e,t,a){},"76a0":function(e,t,a){"use strict";var n=a("44b7"),i=a.n(n);i.a},"83a9":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"admin-list main-content"},[a("div",{staticClass:"screen-box"},[a("div",{staticClass:"screen-item"},[a("el-input",{staticStyle:{width:"220px"},attrs:{size:"small",placeholder:"请输入管理员名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.fetchData(t)}},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-search",type:"primary"},nativeOn:{click:function(t){return e.fetchData(t)}}},[e._v("搜索")])],1),e._v(" "),a("div",{staticClass:"operation"},[a("el-button",{attrs:{size:"small",icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.showDialog("add")}}},[e._v("新增")])],1)]),e._v(" "),a("div",{staticClass:"content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.adminList,fit:"","highlight-current-row":"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:"序号",align:"center",width:"100",type:"index"}}),e._v(" "),a("el-table-column",{attrs:{label:"管理员账号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.username))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"管理员角色",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.role?a("span",[e._v(e._s(t.row.role.role_name))]):a("span",[e._v("未设置")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"管理员状态",align:"center",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e._f("statusFilter")(t.row.status)}},[e._v(e._s(0==t.row.status?"禁用":"启用"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("timeFormat")(t.row.createTime))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("timeFormat")(t.row.updateTime))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},nativeOn:{click:function(a){return e.showDialog("detail",t.row)}}},[e._v("查看")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.row._id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{total:e.total,"current-page":e.currentPage,"page-sizes":[5,10,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{center:"",title:"add"==e.dialogType?"新增管理员":"edit"==e.dialogType?"编辑管理员":"管理员详情",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px","label-position":"rigth",size:"small"}},[a("el-form-item",{attrs:{label:"登录账号",prop:"username"}},[a("el-input",{attrs:{disabled:"detail"==e.dialogType},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username "}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{attrs:{disabled:"detail"==e.dialogType},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone "}})],1),e._v(" "),"detail"!==e.dialogType?a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{type:"password",disabled:"detail"==e.dialogType},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password "}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"管理员角色",prop:"role"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{"value-key":"_id",placeholder:"请选择",disabled:"detail"==e.dialogType},on:{change:e.roleSelect},model:{value:e.selectRole,callback:function(t){e.selectRole=t},expression:"selectRole"}},e._l(e.rolesList,(function(e){return a("el-option",{key:e._id,attrs:{label:e.role_name,value:e}})})),1)],1),e._v(" "),a("el-form-item",["detail"!==e.dialogType?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("保存")]):a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogType="edit"}}},[e._v("编辑")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},i=[],r=a("0fea"),o=a("61f7"),l=a("ed08"),s={filters:{timeFormat:function(e){return Object(l["b"])(new Date(e))},statusFilter:function(e){var t={1:"success",0:"danger"};return t[e]}},data:function(){var e=function(e,t,a){Object(o["b"])(t)?a():a(new Error("手机号不正确"))};return{loading:!0,keywords:"",adminList:[],dialogFormVisible:!1,form:{username:"",phone:"",password:"",avatar:"",role:""},selectRole:{},pageSize:10,currentPage:1,total:0,rolesList:[],rules:{username:[{required:!0,message:"请填写管理员姓名",trigger:"blur"}],password:[{required:!0,message:"请填写管理员密码",trigger:"blur"}],phone:[{required:!0,trigger:"blur",validator:e}],role:[{required:!0,message:"请选择角色",trigger:"change"}]},dialogType:"add"}},watch:{dialogFormVisible:function(e){!1===e&&(this.$refs.form.resetFields(),this.$refs.form.clearValidate(),this.form={username:"",password:"",avatar:"",role:""})}},mounted:function(){this.fetchData(),this.getRoleList()},methods:{fetchData:function(){var e=this;r["a"].getAdminList({pageSize:this.pageSize,currentPage:this.currentPage}).then((function(t){e.adminList=t.data.list,e.total=t.data.count}))},getRoleList:function(){var e=this;r["c"].roleList({currentPage:1,pageSize:1e3}).then((function(t){e.rolesList=t.data.list}))},showDialog:function(e,t){this.dialogType=e,this.dialogFormVisible=!0,t&&t._id&&(this.form=t,this.selectRole=t.role)},roleSelect:function(e){this.form.role=e._id},onSubmit:function(e){var t=this,a=this;a.$refs[e].validate((function(n){if(!n)return!1;a.form._id?r["a"].editAdmin(a.form).then((function(n){200===n.code?(t.$message({type:"success",message:n.msg||"修改成功!"}),t.$nextTick((function(){a.$refs[e].resetFields()})),t.dialogFormVisible=!1,t.fetchData()):t.$message.error(n.msg||"修改失败!")})):r["a"].addAdmin(a.form).then((function(n){200===n.code?(t.$message({type:"success",message:n.msg||"添加成功!"}),t.$nextTick((function(){a.$refs[e].resetFields()})),t.dialogFormVisible=!1,t.fetchData()):t.$message.error(n.msg||"添加失败!")}))}))},handleCurrentChange:function(e){this.currentPage=e,this.fetchData()},handleSizeChange:function(e){this.pageSize=e,this.fetchData()},handleDelete:function(e){var t=this;this.$confirm("是否删除该管理员?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",confirmButtonClass:"danger"}).then((function(){r["a"].delAdmin({id:e}).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.fetchData()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},c=s,u=(a("76a0"),a("8deb5"),a("2877")),d=Object(u["a"])(c,n,i,!1,null,"19192652",null);t["default"]=d.exports},"8deb5":function(e,t,a){"use strict";var n=a("1735"),i=a.n(n);i.a}}]);