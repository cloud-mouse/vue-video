(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-593d9e80"],{"0c74":function(e,t,a){},"0fea":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return o}));var i=a("b775"),n={authorityList:function(e){return Object(i["a"])({url:"/admin-api/permission",method:"get",params:e})},addRole:function(e){return Object(i["a"])({url:"/admin-api/role",method:"post",data:e})},editRole:function(e){return Object(i["a"])({url:"/admin-api/role",method:"patch",data:e})},roleList:function(e){return Object(i["a"])({url:"/admin-api/role",method:"get",params:e})},roleDetail:function(e){return Object(i["a"])({url:"/admin-api/role",method:"get",params:e})},delRole:function(e){return Object(i["a"])({url:"/admin-api/role",method:"delete",params:e})}},r={getAdminList:function(e){return Object(i["a"])({url:"/admin-api/admin",method:"get",params:e})},addAdmin:function(e){return Object(i["a"])({url:"/admin-api/admin",method:"post",data:e})},delAdmin:function(e){return Object(i["a"])({url:"/admin-api/admin",method:"get",params:e})},editAdmin:function(e){return Object(i["a"])({url:"/admin-api/admin",method:"patch",data:e})}},o={getList:function(e){return Object(i["a"])({url:"/admin-api/permission",method:"get",params:e})},addItem:function(e){return Object(i["a"])({url:"/admin-api/permission",method:"post",data:e})},updateItem:function(e){return Object(i["a"])({url:"/admin-api/permission",method:"patch",data:e})},deleteItem:function(e){return Object(i["a"])({url:"/admin-api/permission",method:"delete",params:e})}}},4014:function(e,t,a){"use strict";var i=a("9beb"),n=a.n(i);n.a},7648:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"permission-list main-content"},[a("div",{staticClass:"screen-box"},[a("div",{staticClass:"operation"},[a("el-button",{attrs:{size:"small",icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.showDialog("add")}}},[e._v("新增")])],1)]),e._v(" "),a("div",{staticClass:"content"},[a("el-table",{attrs:{data:e.permissionList,"row-key":"_id","tree-props":{children:"children",hasChildren:"hasChildren"}}},[a("el-table-column",{attrs:{prop:"title",label:"菜单名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"path",label:"菜单路由",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"路由名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("timeFormat")(t.row.createTime))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("timeFormat")(t.row.updateTime))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},nativeOn:{click:function(a){return e.showDialog("detail",t.row)}}},[e._v("查看")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.row._id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{total:e.total,"current-page":e.currentPage,"page-sizes":[5,10,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{center:"",title:"add"==e.dialogType?"新增权限规则":"edit"==e.dialogType?"编辑权限规则":"权限规则详情",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"130px","label-position":"rigth",size:"small"}},[a("el-form-item",{attrs:{label:"父级菜单(pid)",prop:"pid"}},[a("el-cascader",{attrs:{options:e.permissionList,"show-all-levels":!1,props:{value:"_id",label:"title",checkStrictly:!0},clearable:"",disabled:"detail"==e.dialogType},on:{change:e.handleChange},model:{value:e.pid,callback:function(t){e.pid=t},expression:"pid"}}),e._v(" "),a("el-tag",{attrs:{type:"danger"}},[e._v("不选表示顶级")])],1),e._v(" "),a("el-form-item",{attrs:{label:"菜单名称(title)",prop:"title"}},[a("el-input",{attrs:{disabled:"detail"==e.dialogType},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"菜单路由(path)",prop:"path"}},[a("el-input",{attrs:{disabled:"detail"==e.dialogType},model:{value:e.form.path,callback:function(t){e.$set(e.form,"path",t)},expression:"form.path"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路由名称(name)",prop:"name"}},[a("el-input",{attrs:{disabled:"detail"==e.dialogType},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"路由排序(sort)"}},[a("el-input",{attrs:{disabled:"detail"==e.dialogType},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),e._v(" "),a("el-form-item",["detail"!==e.dialogType?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("保存")]):a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogType="edit"}}},[e._v("编辑")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},n=[],r=a("0fea"),o=a("ed08"),l={filters:{timeFormat:function(e){return Object(o["b"])(new Date(e))},statusFilter:function(e){var t={1:"success",0:"danger"};return t[e]}},data:function(){return{loading:!0,keywords:"",permissionList:[],dialogFormVisible:!1,pid:[],form:{pid:"0",title:"",path:"",name:"",sort:"0"},pageSize:10,currentPage:1,total:0,rules:{title:[{required:!0,message:"请填写菜单名称",trigger:"blur"}],path:[{required:!0,trigger:"blur",message:"请填写菜单路由"}],name:[{required:!0,trigger:"blur",message:"请填写路由名称"}]},dialogType:"add"}},watch:{dialogFormVisible:function(e){!1===e&&(this.$refs.form.resetFields(),this.$refs.form.clearValidate(),this.form={pid:0,title:"",path:"",name:"",sort:"0"},this.pid=[])}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;r["b"].getList({pageSize:this.pageSize,currentPage:this.currentPage}).then((function(t){e.permissionList=t.data.list,e.total=t.data.count}))},showDialog:function(e,t){this.dialogType=e,this.dialogFormVisible=!0,t&&t._id&&(this.form=t,this.pid=t.pid)},handleChange:function(e){console.log(e),this.form.pid=e[e.length-1]},onSubmit:function(e){var t=this,a=this;a.$refs[e].validate((function(i){if(!i)return!1;a.form._id?(!a.form.pid||a.form.pid,r["b"].updateItem(a.form).then((function(i){t.$message.success(i.msg),t.$nextTick((function(){a.$refs[e].resetFields()})),t.dialogFormVisible=!1,t.fetchData()})).catch((function(e){t.$message.error(e||"编辑失败!")}))):(!a.form.pid||a.form.pid,r["b"].addItem(a.form).then((function(i){t.$message.success(i.msg),t.$nextTick((function(){a.$refs[e].resetFields()})),t.dialogFormVisible=!1,t.fetchData()})).catch((function(e){t.$message.error(e||"添加失败!")})))}))},handleCurrentChange:function(e){this.currentPage=e,this.fetchData()},handleSizeChange:function(e){this.pageSize=e,this.fetchData()},handleDelete:function(e){var t=this;this.$confirm("是否删除该菜单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",confirmButtonClass:"danger"}).then((function(){r["b"].deleteItem({id:e}).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.fetchData()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},s=l,c=(a("4014"),a("f4a0"),a("2877")),d=Object(c["a"])(s,i,n,!1,null,"02774ec0",null);t["default"]=d.exports},"9beb":function(e,t,a){},f4a0:function(e,t,a){"use strict";var i=a("0c74"),n=a.n(i);n.a}}]);