(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4478ec53"],{"093a":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return o}));var i=a("b775"),n={getList:function(e){return Object(i["a"])({url:"/admin-api/movieClass",method:"get",params:e})},addItem:function(e){return Object(i["a"])({url:"/admin-api/movieClass",method:"post",data:e,headers:{"Content-Type":"application/json; charset=utf-8"}})},updateItem:function(e){return Object(i["a"])({url:"/admin-api/movieClass",method:"patch",data:e})},deleteItem:function(e){return Object(i["a"])({url:"/admin-api/movieClass",method:"delete",params:e})}},r={getList:function(e){return Object(i["a"])({url:"/admin-api/movie",method:"get",params:e})},addItem:function(e){return Object(i["a"])({url:"/admin-api/movie",method:"post",data:e})},deleteItem:function(e){return Object(i["a"])({url:"/admin-api/movie",method:"delete",params:e})},updateItem:function(e){return Object(i["a"])({url:"/admin-api/movie",method:"patch",data:e})}},o={getList:function(e){return Object(i["a"])({url:"/admin-api/movieEpisodes",method:"get",params:e})},addItem:function(e){return Object(i["a"])({url:"/admin-api/movieEpisodes",method:"post",data:e})},deleteItem:function(e){return Object(i["a"])({url:"/admin-api/movieEpisodes",method:"delete",params:e})},updateItem:function(e){return Object(i["a"])({url:"/admin-api/movieEpisodes",method:"patch",data:e})}}},"22df":function(e,t,a){"use strict";var i=a("9dec"),n=a.n(i);n.a},"729a":function(e,t,a){"use strict";var i=a("fcd1"),n=a.n(i);n.a},"970f":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));var i=a("b775"),n={getList:function(e){return Object(i["a"])({url:"/admin-api/gallery",method:"get",params:e})},addItem:function(e){return Object(i["a"])({url:"/admin-api/gallery",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})},deleteImg:function(e){return Object(i["a"])({url:"/admin-api/gallery",method:"delete",params:e})},editItem:function(e){return Object(i["a"])({url:"/admin-api/gallery",method:"patch",data:e})}},r={getGalleryClass:function(e){return Object(i["a"])({url:"/admin-api/gallery/class",method:"get",params:e})},deleteItem:function(e){return Object(i["a"])({url:"/admin-api/gallery/class",method:"delete",params:e})},addItem:function(e){return Object(i["a"])({url:"/admin-api/gallery/class",method:"post",data:e})},editItem:function(e){return Object(i["a"])({url:"/admin-api/gallery/class",method:"patch",data:e})}}},"9dec":function(e,t,a){},a3f0:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"video-class main-content"},[a("div",{staticClass:"screen-box"},[a("div",{staticClass:"operation"},[a("el-button",{attrs:{size:"small",icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.showDialog("add")}}},[e._v("新增")])],1)]),e._v(" "),a("div",{staticClass:"content"},[a("el-table",{attrs:{data:e.videoClassList}},[a("el-table-column",{attrs:{label:"分类图标",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticClass:"class_icon",attrs:{src:e.row.icon,width:"30",height:"30",alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"分类名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sort",label:"分类排序",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("timeFormat")(t.row.createTime))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("timeFormat")(t.row.updateTime))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(a){return e.showDialog("edit",t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.row._id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{total:e.total,"current-page":e.currentPage,"page-sizes":[5,10,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{center:"",title:"add"==e.dialogType?"新增影视分类":"edit"==e.dialogType?"编辑影视分类":"影视分类详情",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"130px","label-position":"rigth",size:"small"}},[a("el-form-item",{attrs:{label:"分类名称(name)",prop:"name"}},[a("el-input",{attrs:{disabled:"detail"==e.dialogType},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分类图标(icon)",prop:"icon"}},[a("img-upload",{attrs:{disabled:"detail"==e.dialogType,"img-data":e.form.icon,"pic-max":1},on:{chooseImg:e.imageChoose}})],1),e._v(" "),a("el-form-item",{attrs:{label:"种类(type)",prop:"type"}},[a("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"输入添加，可多选"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.areaOption,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"类型(genres)",prop:"genres"}},[a("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"输入添加，可多选"},model:{value:e.form.genres,callback:function(t){e.$set(e.form,"genres",t)},expression:"form.genres"}},e._l(e.genresOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"分类排序(sort)"}},[a("el-input",{attrs:{disabled:"detail"==e.dialogType},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分类描述(desc)"}},[a("el-input",{attrs:{disabled:"detail"==e.dialogType},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),a("el-form-item",["detail"!==e.dialogType?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("保存")]):a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogType="edit"}}},[e._v("编辑")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},n=[],r=a("093a"),o=a("ed08"),s=a("5f87"),l=a("5aa94"),c={components:{ImgUpload:l["a"]},filters:{timeFormat:function(e){return Object(o["b"])(new Date(e))}},data:function(){return{loading:!0,keywords:"",videoClassList:[],dialogFormVisible:!1,token:Object(s["b"])(),form:{name:"",type:[],genres:[],icon:"",sort:0,description:""},pageSize:10,currentPage:1,total:0,rules:{name:[{required:!0,trigger:"blur",message:"请填写分类名称"}],icon:[{required:!0,trigger:"blur",message:"请上传分类图标"}],type:[{required:!0,trigger:"change",message:"请选择地区"}],genres:[{required:!0,trigger:"change",message:"请选择类型"}]},areaOption:[],genresOptions:[],dialogType:"add"}},watch:{dialogFormVisible:function(e){!1===e&&(this.$refs.form.resetFields(),this.$refs.form.clearValidate(),this.form={name:"",type:[],genres:[],description:"",icon:"",sort:0})}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;r["b"].getList({pageSize:this.pageSize,currentPage:this.currentPage}).then((function(t){e.videoClassList=t.data.list,e.total=t.data.count}))},showDialog:function(e,t){this.dialogType=e,this.dialogFormVisible=!0,t&&t._id&&(this.form=JSON.parse(JSON.stringify(t)))},onSubmit:function(e){var t=this,a=this;a.$refs[e].validate((function(i){if(!i)return!1;a.form._id?r["b"].updateItem(a.form).then((function(i){t.$message.success(i.msg),t.$nextTick((function(){a.$refs[e].resetFields()})),t.dialogFormVisible=!1,t.fetchData()})).catch((function(e){t.$message.error(e||"编辑失败!")})):r["b"].addItem(a.form).then((function(i){t.$message.success(i.msg),t.$nextTick((function(){a.$refs[e].resetFields()})),t.dialogFormVisible=!1,t.fetchData()})).catch((function(e){t.$message.error(e||"添加失败!")}))}))},imageChoose:function(e){this.form.icon=e,this.$refs.form.validateField("icon")},handleAvatarSuccess:function(e,t){200===e.code?(this.form.icon=e.data.path,this.$message.success(e.msg)):this.$message.error(e.msg)},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传图片只能是 JPG/PNG 格式!"),a||this.$message.error("上传图片大小不能超过 2MB!"),t&&a},handleCurrentChange:function(e){this.currentPage=e,this.fetchData()},handleSizeChange:function(e){this.pageSize=e,this.fetchData()},handleDelete:function(e){var t=this;this.$confirm("是否删除该分类?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",confirmButtonClass:"danger"}).then((function(){r["b"].deleteItem({id:e}).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.fetchData()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},u=c,d=(a("729a"),a("22df"),a("2877")),m=Object(d["a"])(u,i,n,!1,null,"01e7214a",null);t["default"]=m.exports},fcd1:function(e,t,a){}}]);