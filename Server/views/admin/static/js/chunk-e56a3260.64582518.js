(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e56a3260"],{"0fea":function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return o}));var r=n("b775"),i={authorityList:function(t){return Object(r["a"])({url:"/admin-api/permission",method:"get",params:t})},addRole:function(t){return Object(r["a"])({url:"/admin-api/role",method:"post",data:t})},editRole:function(t){return Object(r["a"])({url:"/admin-api/role",method:"patch",data:t})},roleList:function(t){return Object(r["a"])({url:"/admin-api/role",method:"get",params:t})},roleDetail:function(t){return Object(r["a"])({url:"/admin-api/role",method:"get",params:t})},delRole:function(t){return Object(r["a"])({url:"/admin-api/role",method:"delete",params:t})}},a={getAdminList:function(t){return Object(r["a"])({url:"/admin-api/admin",method:"get",params:t})},addAdmin:function(t){return Object(r["a"])({url:"/admin-api/admin",method:"post",data:t})},delAdmin:function(t){return Object(r["a"])({url:"/admin-api/admin",method:"get",params:t})},editAdmin:function(t){return Object(r["a"])({url:"/admin-api/admin",method:"patch",data:t})}},o={getList:function(t){return Object(r["a"])({url:"/admin-api/permission",method:"get",params:t})},addItem:function(t){return Object(r["a"])({url:"/admin-api/permission",method:"post",data:t})},updateItem:function(t){return Object(r["a"])({url:"/admin-api/permission",method:"patch",data:t})},deleteItem:function(t){return Object(r["a"])({url:"/admin-api/permission",method:"delete",params:t})}}},b7c9:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=this,n=e.$createElement,r=e._self._c||n;return r("div",{staticClass:"role-edit roles"},[r("div",{staticClass:"title-info"},[r("card-tag",{attrs:{"tag-name":""!=e.id?"编辑角色":"新增角色"}})],1),e._v(" "),r("div",{staticClass:"form-info"},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","label-position":"top",size:"small"}},[r("el-form-item",{attrs:{label:"角色名称",prop:"admin_role_name"}},[r("el-input",{staticStyle:{width:"30%"},attrs:{disabled:""},model:{value:e.form.admin_role_name,callback:function(t){e.$set(e.form,"admin_role_name",t)},expression:"form.admin_role_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色权限"}},[r("div",{staticClass:"permission-tree"},[r("el-tree",{ref:"tree",attrs:{disabled:"",data:e.getRulesList,"default-checked-keys":e.defaultChecked,props:e.defaultProps,"default-expand-all":"","show-checkbox":"","node-key":"id"},on:{check:e.checkHandle}})],1)]),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(){return t.$router.push({path:"/manage/roles/edit?id="+e.id})}}},[e._v("编辑")]),e._v(" "),r("el-button",{on:{click:function(){return t.$router.go(-1)}}},[e._v("返回")])],1)],1)],1)])},i=[],a=(n("96cf"),n("3b8d")),o=n("b319"),u=n("0fea"),s=(n("ac6a"),n("ed08"));function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pid",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"children",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=[];return t&&t.forEach((function(t){if(t[r]===e){null!==a&&(t=Object(s["e"])(t,a));var u=d(t,t[n],n,r,i,a);u.length&&(t[i]=u),o.push(t)}})),o}function l(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_id",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pid",i=[];return t&&t.forEach((function(a){if(a[n]===e){i.unshift(a[r]);var o=l(t,a[r],n,r);o.length&&(i=i.concat(o))}})),i}function c(t,e,n,r){return t&&t.map((function(t){t[e]===n?Object(s["e"])(t,r):c(t.children,e,n,r)})),t}var m={listToTreeMulti:d,getParentsId:l,upadteArr:c},h=m,f={components:{CardTag:o["a"]},data:function(){return{id:"",authorityList:[],defaultChecked:[],form:{admin_role_name:"",authority_list:[]},rules:{admin_role_name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},defaultProps:{children:"children",label:"auth_name"}}},computed:{getRulesList:function(){return h.listToTreeMulti(this.authorityList)}},created:function(){this.getPermission(),this.id=this.$route.query.id?this.$route.query.id:"",this.$route.query.id&&this.getRoleInfo(this.$route.query.id)},methods:{getPermission:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u["c"].authorityList().then((function(t){e.authorityList=t.data}));case 2:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),getRoleInfo:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u["c"].roleDetail({admin_role_id:e}).then((function(t){n.form.admin_role_name=t.data.admin_role_name,n.$refs.tree.setCheckedKeys(t.data.authority_list)}));case 2:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),checkHandle:function(t){var e=this.$refs.tree.getHalfCheckedKeys().join(","),n=this.$refs.tree.getCheckedKeys().join(",");this.form.authority_list=n,e.length&&0===n.length?this.form.authority_list=e:0===e.length&&n.length?this.form.authority_list=n:this.form.authority_list=""},onSubmit:function(t){var e=this,n=this;n.$refs[t].validate((function(t){if(!t)return!1;n.form.id?(console.log(1),console.log(n.form)):u["c"].addRole(e.form).then((function(t){e.$message({type:"success",message:t.msg}),n.$router.go(-1)})).catch((function(){e.$message({type:"info",message:"创建失败"})}))}))}}},p=f,g=n("2877"),b=Object(g["a"])(p,r,i,!1,null,null,null);e["default"]=b.exports}}]);