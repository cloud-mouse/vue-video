(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-commons"],{"09e0":function(t,i,s){"use strict";var e=s("6afe"),a=s.n(e);a.a},2862:function(t,i,s){},"2f76":function(t,i,s){},"371d":function(t,i,s){},"5aa9":function(t,i,s){"use strict";var e=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"clearBoth"},[t.imgList&&t.imgList.length>0&&t.picMax>1?s("div",{staticClass:"img-list"},[s("draggable",{staticClass:"wrapper",model:{value:t.imgList,callback:function(i){t.imgList=i},expression:"imgList"}},[s("transition-group",t._l(t.imgList,(function(i,e){return s("div",{key:e+i,staticClass:"img-item"},[t.disabled?t._e():s("i",{staticClass:"el-icon-circle-close close-btn",on:{click:function(i){return t.deleteImg(e)}}}),t._v(" "),t.widths?s("img",{staticStyle:{width:"315px",height:"88px"},attrs:{src:i}}):s("img",{attrs:{src:i}})])})),0)],1)],1):t._e(),t._v(" "),1==t.picMax&&""!=t.imgList?s("div",{staticClass:"img-list"},[s("div",{staticClass:"img-item"},[t.disabled?t._e():s("i",{staticClass:"el-icon-circle-close close-btn",on:{click:function(i){return t.deleteImg()}}}),t._v(" "),t.widths?s("img",{style:"width:{widths}}px;height:88px;",attrs:{src:t.imgList}}):s("img",{attrs:{src:t.imgList,width:"100",height:"100"}})])]):t._e(),t._v(" "),t.disabled?t._e():s("div",[t.imgList&&t.imgList.length<t.picMax?s("div",{staticClass:"img-box",on:{click:t.showGoodsModal}},[t.disabled?t._e():s("i",{staticClass:"el-icon-plus"})]):t._e(),t._v(" "),1==t.picMax&&""==t.imgList?s("div",{staticClass:"img-box",on:{click:t.showGoodsModal}},[t.disabled?t._e():s("i",{staticClass:"el-icon-plus"})]):t._e()]),t._v(" "),s("image-modal",{attrs:{visible:t.imageModalConfig.visible,"pic-max":t.picMax},on:{"update:visible":function(i){return t.$set(t.imageModalConfig,"visible",i)},confirm:t.imageChoose,close:t.closeModel}})],1)},a=[],o=(s("ac6a"),s("c5f6"),function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("el-dialog",{attrs:{width:"1040px",visible:t.visibleInside,title:"我的图片","append-to-body":"","before-close":t.beforeClose},on:{"update:visible":function(i){t.visibleInside=i}}},[s("div",{staticClass:"modal-header"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(i){t.isAdd=!0}}},[t._v("上传图片")]),t._v(" "),s("el-input",{staticStyle:{float:"right",width:"200px"},attrs:{placeholder:"搜索",size:"small"},model:{value:t.keyword,callback:function(i){t.keyword=i},expression:"keyword"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(i){return i.stopPropagation(),t.getImgList(i)}},slot:"append"})],1)],1),t._v(" "),t.tips?s("p",{staticClass:"img-tips"},[t._v(t._s(t.tips))]):t._e(),t._v(" "),s("div",{staticClass:"img-choose-ctn"},[s("div",{staticClass:"sider-bar"},[s("div",{staticClass:"default-node"},[s("span",{on:{click:t.getAll}},[t._v("全部")]),t._v(" "),s("span",{on:{click:t.getNotGrouped}},[t._v("未分组")])]),t._v(" "),s("el-tree",{attrs:{data:t.categoryList,"current-node-key":0,"node-key":"_id","highlight-current":!0},on:{"node-click":t.chooseCategory},scopedSlots:t._u([{key:"default",fn:function(i){var e=i.data;return s("span",{staticClass:"custom-tree-node"},[s("span",[t._v(t._s(e.name))])])}}])})],1),t._v(" "),s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageAjaxing,expression:"pageAjaxing"}],staticClass:"imgs-ctn"},[t.imageList.length>0?s("div",t._l(t.imageList,(function(i){return s("div",{key:i._id,staticClass:"img-item",on:{click:function(s){return t.chooseImg(i)}}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.activeList.includes(i._id),expression:"activeList.includes(item._id)"}],staticClass:"active"},[s("i",[t._v(t._s(t.activeList.indexOf(i._id)+1))])]),t._v(" "),s("img",{attrs:{src:i.path,alt:i.name}}),t._v(" "),s("span",{staticClass:"img-meta"},[t._v(t._s(i.filename))]),t._v(" "),s("p",{staticClass:"img-title",attrs:{title:i.name}},[t._v(t._s(i.name))])])})),0):t._e(),t._v(" "),t.imageList.length?t._e():s("div",{staticClass:"noData"},[t._v("暂无数据，可点击左上角“上传图片”按钮添加")])])]),t._v(" "),s("div",{staticClass:"page-ctn"},[s("el-pagination",{staticClass:"pull-left",attrs:{layout:"total,  prev, pager, next, jumper",small:!0,"current-page":t.currentPage,"page-size":t.pageSize,total:t.count},on:{"current-change":t.changeList}})],1),t._v(" "),s("span",{staticClass:"dialog-btn-center",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.confirm}},[t._v("确 定")])],1),t._v(" "),s("el-dialog",{attrs:{visible:t.isAdd,title:"上传图片","append-to-body":"","before-close":t.handleClose},on:{"update:visible":function(i){t.isAdd=i}}},[s("el-form",{attrs:{model:t.dialog.upLoadImg,"label-width":"96px"}},[s("el-form-item",{attrs:{label:"图片分组："}},[s("el-cascader",{staticStyle:{width:"50%"},attrs:{options:t.categoryList,size:"small",props:t.selectProp,filterable:!0,clearable:""},model:{value:t.dialog.upLoadImg.class_id,callback:function(i){t.$set(t.dialog.upLoadImg,"class_id",i)},expression:"dialog.upLoadImg.class_id"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"本地图片："}},[t._l(t.dialog.upLoadImg.urlListShow,(function(i,e){return s("span",{key:e,staticClass:"show-imgBox"},[s("i",{staticClass:"el-icon-circle-close delete",on:{click:function(i){return t.deleteShowImg(e)}}}),t._v(" "),s("img",{attrs:{src:t.getUrl(i.raw),width:"100",height:"100",alt:""}})])})),t._v(" "),s("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{action:"","file-list":t.dialog.upLoadImg.urlListShow,"http-request":t.saveImg,multiple:!0,"on-change":t.changeImgList,"auto-upload":!1,"on-success":t.fileUploadSuccess,"show-file-list":!1}},[s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],2)],1),t._v(" "),s("span",{staticClass:"dialog-btn-center",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:t.submitUpload}},[t._v("上传")])],1)],1)],1)}),l=[],n=s("970f"),c={props:{visible:{type:Boolean,default:!1},picMax:{type:Number,default:null},tips:{type:String,default:""}},data:function(){return{baseUrl:Object({NODE_ENV:"production",VUE_APP_BASE_API:"http://movie.zhanghaoblog.top",BASE_URL:""}).VUE_APP_BASE_UPLOAD_URL,isAdd:!1,visibleInside:!1,ajaxing:!1,pageAjaxing:!1,keyword:"",cId:[0],activeList:[],chooseList:[],count:0,totalPages:0,pageSize:10,currentPage:1,categoryList:[],imageList:[],dialog:{upLoadImg:{url:null,urlListShow:[],show:!1,class_id:"0"}},uploadCount:0,selectProp:{checkStrictly:!0,value:"_id",label:"name",children:"children",expandTrigger:"hover"}}},watch:{visible:function(t){this.visibleInside=t,t&&(this.activeList=[],this.chooseList=[],this.isAdd=!1,this.getList())},visibleInside:function(t){this.visible!==t&&this.$emit("update:visible",t)}},methods:{beforeClose:function(){this.$emit("close")},changeImgList:function(t,i){var s="image/jpeg"===t.raw.type,e="image/png"===t.raw.type,a=t.size/1024/1024<2;s||e||(this.$message.error("上传头像图片只能是 JPG或png 格式!"),this.dialog.upLoadImg.urlListShow=i.splice(i.length,1)),a||(this.$message.error("上传头像图片大小不能超过 2MB!"),this.dialog.upLoadImg.urlListShow=i.splice(i.length,1)),(e||s)&&a&&(this.dialog.upLoadImg.urlListShow=i)},fileUploadSuccess:function(t,i,s){this.uploadCount++,this.uploadCount===s.length&&(this.uploadCount=0,this.isAdd=!1,this.dialog.upLoadImg.show=!1,this.getImgList(),this.$message({message:"上传图片成功",type:"success"}),this.visibleInside=!1)},saveImg:function(t){var i=this,s=this.dialog.upLoadImg.class_id,e=new FormData;e.append("file",t.file),e.append("class_id",s[s.length-1]),n["a"].addItem(e).then((function(t){200!==t.code?i.$message({message:t.data.msg,type:"error"}):(i.$message({message:"操作成功",type:"success"}),i.isAdd=!1,i.getImgList())}))},deleteShowImg:function(t){this.dialog.upLoadImg.urlListShow.splice(t,1)},submitUpload:function(){var t=this.$refs.upload;t.submit(),this.dialog.upLoadImg.url="",this.dialog.upLoadImg.urlListShow=[]},handleClose:function(){this.isAdd=!1,this.dialog.upLoadImg.url="",this.dialog.upLoadImg.urlListShow=[]},getList:function(){var t=this;n["b"].getGalleryClass().then((function(i){200===i.code?(t.categoryList=i.data.list||[],t.chooseCategory()):t.$message({message:i.msg,type:"error"})}))},changeList:function(t){this.currentPage=t,this.getImgList()},getImgList:function(){var t=this;this.pageAjaxing||(this.pageAjaxing=!0,n["a"].getList({currentPage:this.currentPage,pageSize:this.pageSize,name:this.keyword,class_id:this.cId[this.cId.length-1]}).then((function(i){t.pageAjaxing=!1,200===i.code&&i.data.list?(t.imageList=i.data.list,t.count=i.data.count):t.$message({message:i.data.msg,type:"error"})})))},chooseCategory:function(t,i){this.cId=[];while(i&&!Array.isArray(i.data))this.cId.unshift(i.data._id),i=i.parent;this.cId=t?[t._id]:[""],this.dialog.upLoadImg.class_id=this.cId,this.getImgList()},getAll:function(){this.cId=[""],this.getImgList()},getNotGrouped:function(){this.cId=["0"],this.getImgList()},chooseImg:function(t){if(1===this.picMax)this.chooseList.splice(0,1,t),this.activeList.splice(0,1,t._id);else{var i=this.activeList.indexOf(t._id);-1!==i?(this.activeList.splice(i,1),this.chooseList.splice(i,1)):this.chooseList.length===this.picMax?this.$message({message:"选取图片不能超过".concat(this.picMax,"张"),type:"error"}):(this.chooseList.push(t),this.activeList.push(t._id))}},confirm:function(){this.$emit("confirm",this.chooseList)}}},r=c,d=(s("f052"),s("777e"),s("2877")),g=Object(d["a"])(r,o,l,!1,null,"0428a81b",null),u=g.exports,h=s("b76a"),p=s.n(h),m={components:{ImageModal:u,draggable:p.a},props:{imgData:{type:[Array,String],default:function(){return[]}},disabled:{type:Boolean,default:!1},picMax:{type:Number,default:null},widths:{type:Number,default:0}},data:function(){return{imageModalConfig:{visible:!1},imgList:[]}},watch:{imgData:function(t){this.imgList=t},imgList:function(t){this.change()}},created:function(){this.imgList=this.imgData},methods:{showGoodsModal:function(){this.imageModalConfig.visible=!0},imageChoose:function(t){var i=this;t.forEach((function(t,s){i.imgList.length<i.picMax&&(1===i.picMax?i.imgList=t.path:i.imgList.push(t.path))})),this.$emit("chooseImg",this.imgList),this.imageModalConfig.visible=!1},closeModel:function(){console.log(1),this.imageModalConfig.visible=!1},change:function(){this.$emit("changePsit",this.imgList)},deleteImg:function(t){1===this.picMax?this.imgList="":this.imgList.splice(t,1),this.$emit("chooseImg",this.imgList)}}},f=m,v=(s("e50b"),Object(d["a"])(f,e,a,!1,null,"154816eb",null));i["a"]=v.exports},"6afe":function(t,i,s){},"777e":function(t,i,s){"use strict";var e=s("2862"),a=s.n(e);a.a},b319:function(t,i,s){"use strict";var e=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"card-tag"},[s("div",{staticClass:"tag-content",style:"background:"+t.backColor+";color:"+t.color+";border-radius:"+t.raidus+";display: "+(t.block?"block":"inline-block")},[t.iconName?s("svg-icon",{attrs:{"icon-class":t.iconName}}):t._e(),t._v(" "),s("span",[t._v(t._s(t.tagName))])],1)])},a=[],o=s("c00a"),l={name:"CardTag",components:{SvgIcon:o["a"]},props:{iconName:{type:String,default:""},tagName:{type:String,default:""},backColor:{type:String,default:"#ebebeb"},color:{type:String,default:"#31708f"},raidus:{type:String,default:""},block:{type:Boolean,default:!0}}},n=l,c=(s("09e0"),s("2877")),r=Object(c["a"])(n,e,a,!1,null,"7e2c6418",null);i["a"]=r.exports},e50b:function(t,i,s){"use strict";var e=s("2f76"),a=s.n(e);a.a},f052:function(t,i,s){"use strict";var e=s("371d"),a=s.n(e);a.a}}]);