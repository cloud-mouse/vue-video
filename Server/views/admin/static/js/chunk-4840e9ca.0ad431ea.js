(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4840e9ca"],{8084:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ad-list main-content"},[a("div",{staticClass:"screen-box"},[a("div",{staticClass:"operation"},[a("el-button",{attrs:{size:"small",icon:"el-icon-plus",type:"primary"},on:{click:function(e){return t.showDialog("add")}}},[t._v("新增")])],1)]),t._v(" "),a("div",{staticClass:"content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.adList,fit:"","highlight-current-row":"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:"序号",align:"center",width:"100",type:"index"}}),t._v(" "),a("el-table-column",{attrs:{label:"广告位图片",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{attrs:{src:t.row.path,alt:"",width:"60",height:"60"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t._f("statusFilter")(e.row.status)}},[t._v(t._s("0"===e.row.status?"下架":"上架"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t._f("timeFormat")(e.row.createTime))+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t._f("timeFormat")(e.row.updateTime))+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},nativeOn:{click:function(a){return t.showDialog("detail",e.row)}}},[t._v("查看")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.row._id)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{center:"",title:"add"==t.dialogType?"新增广告位":"edit"==t.dialogType?"编辑广告位":"广告位详情",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px","label-position":"left",size:"small"}},[a("el-form-item",{attrs:{label:"广告位名称",prop:"name"}},[a("el-input",{attrs:{disabled:"detail"==t.dialogType},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"广告位图片",prop:"path"}},[a("img-upload",{attrs:{disabled:"detail"==t.dialogType,"img-data":t.form.path,"pic-max":1},on:{chooseImg:t.imageChoose}})],1),t._v(" "),a("el-form-item",{attrs:{label:"排序"}},[a("el-input",{attrs:{disabled:"detail"==t.dialogType},model:{value:t.form.sort,callback:function(e){t.$set(t.form,"sort",e)},expression:"form.sort"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"链接"}},[a("el-input",{attrs:{disabled:"detail"==t.dialogType},model:{value:t.form.link,callback:function(e){t.$set(t.form,"link",e)},expression:"form.link"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"是否上架"}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}})],1),t._v(" "),a("el-form-item",["detail"!==t.dialogType?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("form")}}},[t._v("保存")]):a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogType="edit"}}},[t._v("编辑")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")])],1)],1)],1)],1)},n=[],r=a("8593"),s=a("ed08"),o=a("5f87"),l=a("5aa94"),u={components:{ImgUpload:l["a"]},filters:{timeFormat:function(t){return Object(s["b"])(new Date(t))},statusFilter:function(t){var e={1:"success",0:"danger"};return e[t]}},data:function(){return{loading:!0,adList:[],token:Object(o["b"])(),dialogFormVisible:!1,form:{name:"",path:"",sort:"0",link:"",status:"1"},btnLoading:!1,rules:{name:[{required:!0,message:"请输入广告位名称",trigger:"blur"}],path:[{required:!0,message:"请上传广告位图片",trigger:"blur"}]},dialogType:"add"}},watch:{dialogFormVisible:function(t){!1===t&&(this.$refs["form"].resetFields(),this.form={name:"",path:"",sort:"",link:"",status:"1"})}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var t=this;r["a"].getList().then((function(e){t.loading=!1,t.adList=e.data})).catch((function(){t.loading=!1}))},showDialog:function(t,e){this.dialogType=t,this.dialogFormVisible=!0,e&&e._id&&(this.form=JSON.parse(JSON.stringify(e)))},onSubmit:function(t){var e=this,a=this;a.$refs[t].validate((function(i){if(!i)return!1;a.form._id?r["a"].updateItem(a.form).then((function(i){200===i.code?(e.$message({type:"success",message:i.msg||"修改成功!"}),a.$refs[t].resetFields(),e.dialogFormVisible=!1,e.fetchData()):e.$message({type:"info",message:i.msg||"修改失败!"})})):r["a"].addItem(a.form).then((function(i){200===i.code?(e.$message({type:"success",message:i.msg||"添加成功!"}),a.$refs[t].resetFields(),e.dialogFormVisible=!1,e.fetchData()):e.$message.success(i.msg||"添加失败!")}))}))},imageChoose:function(t){this.form.path=t,this.$refs.form.validateField("path")},handleAvatarSuccess:function(t,e){200===t.code?(this.form.path=t.data.path,this.$message.success(t.msg)):this.$message.error(t.msg)},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type,a=t.size/1024/1024<2;return e||this.$message.error("上传图片只能是 JPG/PNG 格式!"),a||this.$message.error("上传图片大小不能超过 2MB!"),e&&a},handleDelete:function(t){var e=this;this.$confirm("是否删除该广告位?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",confirmButtonClass:"danger"}).then((function(){r["a"].deleteItem({id:t}).then((function(t){e.$message({type:"success",message:"删除成功!"}),e.fetchData()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))}}},c=u,d=(a("935a"),a("2877")),m=Object(d["a"])(c,i,n,!1,null,"b1ab6d02",null);e["default"]=m.exports},8593:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}));var i=a("b775"),n={getList:function(t){return Object(i["a"])({url:"/admin-api/slider",method:"get",params:t})},addItem:function(t){return Object(i["a"])({url:"/admin-api/slider",method:"post",data:t})},updateItem:function(t){return Object(i["a"])({url:"/admin-api/slider",method:"patch",data:t})},deleteItem:function(t){return Object(i["a"])({url:"/admin-api/slider",method:"delete",params:t})}},r={getSetting:function(t){return Object(i["a"])({url:"/system/getSetting",methods:"get",params:t})},editSetting:function(t){return Object(i["a"])({url:"/system/editSetting",method:"post",data:t})},getWxConfig:function(t){return Object(i["a"])({url:"/system/getWxConfig",methods:"get",params:t})},saveWxConfig:function(t){return Object(i["a"])({url:"/system/saveWxConfig",method:"post",data:t})},getShopConfig:function(t){return Object(i["a"])({url:"/system/getShopConfig",methods:"get",params:t})},saveShopConfig:function(t){return Object(i["a"])({url:"/system/saveShopConfig",method:"post",data:t})}}},"935a":function(t,e,a){"use strict";var i=a("de8f"),n=a.n(i);n.a},"970f":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}));var i=a("b775"),n={getList:function(t){return Object(i["a"])({url:"/admin-api/gallery",method:"get",params:t})},addItem:function(t){return Object(i["a"])({url:"/admin-api/gallery",method:"post",headers:{"Content-Type":"multipart/form-data"},data:t})},deleteImg:function(t){return Object(i["a"])({url:"/admin-api/gallery",method:"delete",params:t})},editItem:function(t){return Object(i["a"])({url:"/admin-api/gallery",method:"patch",data:t})}},r={getGalleryClass:function(t){return Object(i["a"])({url:"/admin-api/gallery/class",method:"get",params:t})},deleteItem:function(t){return Object(i["a"])({url:"/admin-api/gallery/class",method:"delete",params:t})},addItem:function(t){return Object(i["a"])({url:"/admin-api/gallery/class",method:"post",data:t})},editItem:function(t){return Object(i["a"])({url:"/admin-api/gallery/class",method:"patch",data:t})}}},de8f:function(t,e,a){}}]);