(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50facd08"],{"093a":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return o})),i.d(t,"c",(function(){return s}));var a=i("b775"),n={getList:function(e){return Object(a["a"])({url:"/admin-api/movieClass",method:"get",params:e})},addItem:function(e){return Object(a["a"])({url:"/admin-api/movieClass",method:"post",data:e,headers:{"Content-Type":"application/json; charset=utf-8"}})},updateItem:function(e){return Object(a["a"])({url:"/admin-api/movieClass",method:"patch",data:e})},deleteItem:function(e){return Object(a["a"])({url:"/admin-api/movieClass",method:"delete",params:e})}},o={getList:function(e){return Object(a["a"])({url:"/admin-api/movie",method:"get",params:e})},addItem:function(e){return Object(a["a"])({url:"/admin-api/movie",method:"post",data:e})},deleteItem:function(e){return Object(a["a"])({url:"/admin-api/movie",method:"delete",params:e})},updateItem:function(e){return Object(a["a"])({url:"/admin-api/movie",method:"patch",data:e})}},s={getList:function(e){return Object(a["a"])({url:"/admin-api/movieEpisodes",method:"get",params:e})},addItem:function(e){return Object(a["a"])({url:"/admin-api/movieEpisodes",method:"post",data:e})},deleteItem:function(e){return Object(a["a"])({url:"/admin-api/movieEpisodes",method:"delete",params:e})},updateItem:function(e){return Object(a["a"])({url:"/admin-api/movieEpisodes",method:"patch",data:e})}}},"13c5":function(e,t,i){},2472:function(e,t,i){"use strict";var a=i("13c5"),n=i.n(a);n.a},b8b2:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"video-list main-content"},[i("div",{staticClass:"screen-box"},[i("div",{staticClass:"video-detail"},[i("img",{attrs:{src:e.detail.cover,alt:""}}),e._v(" "),i("div",[i("p",[e._v("剧名："),i("span",[e._v(e._s(e.detail.name))])]),e._v(" "),i("p",[e._v("分类："),i("span",[e._v(e._s(e.detail.movie_class.name))])]),e._v(" "),i("p",[e._v("状态："),i("span",[e._v(e._s("1"===e.detail.isOver?"已完结":"连载中..."))])]),e._v(" "),i("p",[e._v("简介："),i("span",[e._v(e._s(e.detail.description))])])])])]),e._v(" "),i("div",{staticClass:"content"},[i("div",{staticClass:"title"},[e._v("剧集列表")]),e._v(" "),e._l(e.episodesList,(function(t){return i("el-tag",{key:t._id,staticClass:"episode-item",attrs:{closable:"",type:"info",effect:"plain","disable-transitions":!1},on:{click:function(i){return e.showDialog("edit",t)},close:function(i){return e.handleDelete(t._id)}}},[e._v("\n      第"+e._s(t.index)+"集："+e._s(t.name)+"\n    ")])})),e._v(" "),i("el-button",{attrs:{size:"medium",icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.showDialog("add")}}},[e._v("新增")])],2),e._v(" "),i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{center:"",title:"add"==e.dialogType?"新增剧集":"edit"==e.dialogType?"编辑剧集":"剧集详情",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"130px","label-position":"rigth",size:"small"}},[i("el-form-item",{attrs:{label:"剧集名称",prop:"name"}},[i("el-input",{attrs:{placeholder:"输入剧集名称",disabled:"detail"==e.dialogType},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"剧集资源",prop:"url"}},[i("el-input",{attrs:{placeholder:"输入剧集资源",disabled:"detail"==e.dialogType},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"第几集",prop:"index"}},[i("el-input",{attrs:{placeholder:"输入第几集（请谨慎填写）",disabled:"detail"==e.dialogType},model:{value:e.form.index,callback:function(t){e.$set(e.form,"index",t)},expression:"form.index"}})],1),e._v(" "),i("el-form-item",["detail"!==e.dialogType?i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("保存")]):i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogType="edit"}}},[e._v("编辑")]),e._v(" "),i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},n=[],o=i("093a"),s={data:function(){return{loading:!0,detail:null,episodesList:[],dialogFormVisible:!1,form:{name:"",url:"",movie_id:this.$route.query.id,index:""},total:0,rules:{name:[{required:!0,trigger:"blur",message:"请填写剧集名"}],url:[{required:!0,trigger:"blur",message:"请上传影视资源"}]},dialogType:"add"}},watch:{dialogFormVisible:function(e){!1===e&&(this.$refs.form.resetFields(),this.$refs.form.clearValidate(),this.form={name:"",url:"",movie_id:this.$route.query.id,index:""})}},created:function(){this.fetchData(),this.getDetail()},handleClose:function(e){console.log(e)},methods:{fetchData:function(){var e=this;o["c"].getList({pageSize:1e4,currentPage:1,movie_id:this.$route.query.id}).then((function(t){e.episodesList=t.data.list,e.total=t.data.count}))},getDetail:function(){var e=this;o["a"].getList({id:this.$route.query.id}).then((function(t){e.detail=t.data}))},showDialog:function(e,t){this.dialogType=e,this.dialogFormVisible=!0,t&&t._id&&(this.form=JSON.parse(JSON.stringify(t)))},onSubmit:function(e){var t=this,i=this;i.$refs[e].validate((function(a){if(!a)return!1;i.form._id?o["c"].updateItem(i.form).then((function(a){t.$message.success(a.msg),t.$nextTick((function(){i.$refs[e].resetFields()})),t.dialogFormVisible=!1,t.fetchData()})).catch((function(e){t.$message.error(e||"编辑失败!")})):o["c"].addItem(i.form).then((function(a){t.$message.success(a.msg),t.$nextTick((function(){i.$refs[e].resetFields()})),t.dialogFormVisible=!1,t.fetchData()})).catch((function(e){t.$message.error(e||"添加失败!")}))}))},handleDelete:function(e){var t=this;this.$confirm("是否删除该剧集?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",confirmButtonClass:"danger"}).then((function(){o["c"].deleteItem({id:e}).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.fetchData()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},r=s,l=(i("2472"),i("2877")),d=Object(l["a"])(r,a,n,!1,null,"7281084d",null);t["default"]=d.exports}}]);